define(["jquery","core/log","filter_poodll/uploader"],function(a,b,c){"use strict";return b.debug("PoodLL upload Recorder: initialising"),{config:null,supports_current_browser:function(a){return!0},embed:function(a,b){this.config=b,this.insert_controls(a),c.init(a,b),this.register_events()},insert_controls:function(b){var c="",d=this.config;switch(d.mediatype){case"video":c="video/*";break;case"audio":default:var e=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;c=e?"video/*":"audio/*"}var f='<div class="p_btn_wrapper">';f+='<input type="file" id="'+d.widgetid+'_poodllfileselect" name="poodllfileselect[]" accept="'+c+'"/>',f+='<button type="button" class="p_btn">'+M.util.get_string("recui_recordorchoose","filter_poodll")+"</button>",f+="</div>",a(b).prepend(f)},register_events:function(){var b=this,c=this.config;a("#"+c.widgetid+"_poodllfileselect").on("change",function(a){b.FileSelectHandler(a)})},FileSelectHandler:function(a){for(var b,d=a.target.files||a.dataTransfer.files,e=0;b=d[e];e++)c.uploadBlob(b,b.type)},ParseFile:function(a){var b="",d=new FileReader;d.onloadend=function(d){b=d.target.result,c.uploadFile(b,a.type)},d.readAsDataURL(a)}}});