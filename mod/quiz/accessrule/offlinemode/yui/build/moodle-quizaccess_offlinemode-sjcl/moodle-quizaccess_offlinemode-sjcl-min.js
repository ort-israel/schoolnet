YUI.add("moodle-quizaccess_offlinemode-sjcl",function(e,t){"use strict";var n={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};typeof module!="undefined"&&module.exports&&(module.exports=n),typeof define=="function"&&define([],function(){return n}),n.cipher.aes=function(e){this._tables[0][0][0]||this._precompute();var t,r,i,s,o,u=this._tables[0][4],a=this._tables[1],f=e.length,l=1;if(f!==4&&f!==6&&f!==8)throw new n.exception.invalid("invalid aes key size");this._key=[s=e.slice(0),o=[]];for(t=f;t<4*f+28;t++){i=s[t-1];if(t%f===0||f===8&&t%f===4)i=u[i>>>24]<<24^u[i>>16&255]<<16^u[i>>8&255]<<8^u[i&255],t%f===0&&(i=i<<8^i>>>24^l<<24,l=l<<1^(l>>7)*283);s[t]=s[t-f]^i}for(r=0;t;r++,t--)i=s[r&3?t:t-4],t<=4||r<4?o[r]=i:o[r]=a[0][u[i>>>24]]^a[1][u[i>>16&255]]^a[2][u[i>>8&255]]^a[3][u[i&255]]},n.cipher.aes.prototype={encrypt:function(e){return this._crypt(e,0)},decrypt:function(e){return this._crypt(e,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var e=this._tables[0],t=this._tables[1],n=e[4],r=t[4],i,s,o,u=[],a=[],f,l,c,h,p,d;for(i=0;i<256;i++)a[(u[i]=i<<1^(i>>7)*283)^i]=i;for(s=o=0;!n[s];s^=f||1,o=a[o]||1){h=o^o<<1^o<<2^o<<3^o<<4,h=h>>8^h&255^99,n[s]=h,r[h]=s,c=u[l=u[f=u[s]]],d=c*16843009^l*65537^f*257^s*16843008,p=u[h]*257^h*16843008;for(i=0;i<4;i++)e[i][s]=p=p<<24^p>>>8,t[i][h]=d=d<<24^d>>>8}for(i=0;i<5;i++)e[i]=e[i].slice(0),t[i]=t[i].slice(0)},_crypt:function(e,t){if(e.length!==4)throw new n.exception.invalid("invalid aes block size");var r=this._key[t],i=e[0]^r[0],s=e[t?3:1]^r[1],o=e[2]^r[2],u=e[t?1:3]^r[3],a,f,l,c=r.length/4-2,h,p=4,d=[0,0,0,0],v=this._tables[t],m=v[0],g=v[1],y=v[2],b=v[3],w=v[4];for(h=0;h<c;h++)a=m[i>>>24]^g[s>>16&255]^y[o>>8&255]^b[u&255]^r[p],f=m[s>>>24]^g[o>>16&255]^y[u>>8&255]^b[i&255]^r[p+1],l=m[o>>>24]^g[u>>16&255]^y[i>>8&255]^b[s&255]^r[p+2],u=m[u>>>24]^g[i>>16&255]^y[s>>8&255]^b[o&255]^r[p+3],p+=4,i=a,s=f,o=l;for(h=0;h<4;h++)d[t?3&-h:h]=w[i>>>24]<<24^w[s>>16&255]<<16^w[o>>8&255]<<8^w[u&255]^r[p++],a=i,i=s,s=o,o=u,u=a;return d}},n.bitArray={bitSlice:function(e,t,r){return e=n.bitArray._shiftRight(e.slice(t/32),32-(t&31)).slice(1),r===undefined?e:n.bitArray.clamp(e,r-t)},extract:function(e,t,n){var r,i=Math.floor(-t-n&31);return(t+n-1^t)&-32?r=e[t/32|0]<<32-i^e[t/32+1|0]>>>i:r=e[t/32|0]>>>i,r&(1<<n)-1},concat:function(e,t){if(e.length===0||t.length===0)return e.concat(t);var r=e[e.length-1],i=n.bitArray.getPartial(r);return i===32?e.concat(t):n.bitArray._shiftRight(t,i,r|0,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length,r;return t===0?0:(r=e[t-1],(t-1)*32+n.bitArray.getPartial(r))},clamp:function(e,t){if(e.length*32<t)return e;e=e.slice(0,Math.ceil(t/32));var r=e.length;return t&=31,r>0&&t&&(e[r-1]=n.bitArray.partial(t,e[r-1]&2147483648>>t-1,1)),e},partial:function(e,t,n){return e===32?t:(n?t|0:t<<32-e)+e*1099511627776},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(n.bitArray.bitLength(e)!==n.bitArray.bitLength(t))return!1;var r=0,i;for(i=0;i<e.length;i++)r|=e[i]^t[i];return r===0},_shiftRight:function(e,t,r,i){var s,o=0,u;i===undefined&&(i=[]);for(;t>=32;t-=32)i.push(r),r=0;if(t===0)return i.concat(e);for(s=0;s<e.length;s++)i.push(r|e[s]>>>t),r=e[s]<<32-t;return o=e.length?e[e.length-1]:0,u=n.bitArray.getPartial(o),i.push(n.bitArray.partial(t+u&31,t+u>32?r:i.pop(),1)),i},_xor4:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,n,r=65280;for(t=0;t<e.length;++t)n=e[t],e[t]=n>>>24|n>>>8&r|(n&r)<<8|n<<24;return e}},n.codec.utf8String={fromBits:function(e){var t="",r=n.bitArray.bitLength(e),i,s;for(i=0;i<r/8;i++)(i&3)===0&&(s=e[i/4]),t+=String.fromCharCode(s>>>24),s<<=8;return decodeURIComponent(escape(t))},toBits:function(e){e=unescape(encodeURIComponent(e));var t=[],r,i=0;for(r=0;r<e.length;r++)i=i<<8|e.charCodeAt(r),(r&3)===3&&(t.push(i),i=0);return r&3&&t.push(n.bitArray.partial(8*(r&3),i)),t}},n.codec.hex={fromBits:function(e){var t="",r;for(r=0;r<e.length;r++)t+=((e[r]|0)+0xf00000000000).toString(16).substr(4);return t.substr(0,n.bitArray.bitLength(e)/4)},toBits:function(e){var t,r=[],i;e=e.replace(/\s|0x/g,""),i=e.length,e+="00000000";for(t=0;t<e.length;t+=8)r.push(parseInt(e.substr(t,8),16)^0);return n.bitArray.clamp(r,i*4)}},n.codec.base32={_chars:"0123456789abcdefghjkmnpqrstvwxyz",BITS:32,BASE:5,REMAINING:27,fromBits:function(e,t){var r=n.codec.base32.BITS,i=n.codec.base32.BASE,s=n.codec.base32.REMAINING,o="",u,a=0,f=n.codec.base32._chars,l=0,c=n.bitArray.bitLength(e);for(u=0;o.length*i<=c;)o+=f.charAt((l^e[u]>>>a)>>>s),a<i?(l=e[u]<<i-a,a+=s,u++):(l<<=i,a-=i);return o},toBits:function(e){var t=n.codec.base32.BITS,r=n.codec.base32.BASE,i=n.codec.base32.REMAINING,s=[],o,u=0,a=n.codec.base32._chars,f=0,l;for(o=0;o<e.length;o++){l=a.indexOf(e.charAt(o));if(l<0)throw new n.exception.invalid("this isn't base32!");u>i?(u-=i,s.push(f^l>>>u),f=l<<t-u):(u+=r,f^=l<<t-u)}return u&56&&s.push(n.bitArray.partial(u&56,f,1)),s}},n.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,r){var i="",s,o=0,u=n.codec.base64._chars,a=0,f=n.bitArray.bitLength(e);r&&(u=u.substr(0,62)+"-_");for(s=0;i.length*6<f;)i+=u.charAt((a^e[s]>>>o)>>>26),o<6?(a=e[s]<<6-o,o+=26,s++):(a<<=6,o-=6);while(i.length&3&&!t)i+="=";return i},toBits:function(e,t){e=e.replace(/\s|=/g,"");var r=[],i,s=0,o=n.codec.base64._chars,u=0,a;t&&(o=o.substr(0,62)+"-_");for(i=0;i<e.length;i++){a=o.indexOf(e.charAt(i));if(a<0)throw new n.exception.invalid("this isn't base64!");s>26?(s-=26,r.push(u^a>>>s),u=a<<32-s):(s+=6,u^=a<<32-s)}return s&56&&r.push(n.bitArray.partial(s&56
,u,1)),r}},n.codec.base64url={fromBits:function(e){return n.codec.base64.fromBits(e,1,1)},toBits:function(e){return n.codec.base64.toBits(e,1)}},n.codec.bytes={fromBits:function(e){var t=[],r=n.bitArray.bitLength(e),i,s;for(i=0;i<r/8;i++)(i&3)===0&&(s=e[i/4]),t.push(s>>>24),s<<=8;return t},toBits:function(e){var t=[],r,i=0;for(r=0;r<e.length;r++)i=i<<8|e[r],(r&3)===3&&(t.push(i),i=0);return r&3&&t.push(n.bitArray.partial(8*(r&3),i)),t}},n.hash.sha256=function(e){this._key[0]||this._precompute(),e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},n.hash.sha256.hash=function(e){return(new n.hash.sha256).update(e).finalize()},n.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){typeof e=="string"&&(e=n.codec.utf8String.toBits(e));var t,r=this._buffer=n.bitArray.concat(this._buffer,e),i=this._length,s=this._length=i+n.bitArray.bitLength(e);for(t=512+i&-512;t<=s;t+=512)this._block(r.splice(0,16));return this},finalize:function(){var e,t=this._buffer,r=this._h;t=n.bitArray.concat(t,[n.bitArray.partial(1,1)]);for(e=t.length+2;e&15;e++)t.push(0);t.push(Math.floor(this._length/4294967296)),t.push(this._length|0);while(t.length)this._block(t.splice(0,16));return this.reset(),r},_init:[],_key:[],_precompute:function(){function r(e){return(e-Math.floor(e))*4294967296|0}var e=0,t=2,n;e:for(;e<64;t++){for(n=2;n*n<=t;n++)if(t%n===0)continue e;e<8&&(this._init[e]=r(Math.pow(t,.5))),this._key[e]=r(Math.pow(t,1/3)),e++}},_block:function(e){var t,n,r,i,s=e.slice(0),o=this._h,u=this._key,a=o[0],f=o[1],l=o[2],c=o[3],h=o[4],p=o[5],d=o[6],v=o[7];for(t=0;t<64;t++)t<16?n=s[t]:(r=s[t+1&15],i=s[t+14&15],n=s[t&15]=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+s[t&15]+s[t+9&15]|0),n=n+v+(h>>>6^h>>>11^h>>>25^h<<26^h<<21^h<<7)+(d^h&(p^d))+u[t],v=d,d=p,p=h,h=c+n|0,c=l,l=f,f=a,a=n+(f&l^c&(f^l))+(f>>>2^f>>>13^f>>>22^f<<30^f<<19^f<<10)|0;o[0]=o[0]+a|0,o[1]=o[1]+f|0,o[2]=o[2]+l|0,o[3]=o[3]+c|0,o[4]=o[4]+h|0,o[5]=o[5]+p|0,o[6]=o[6]+d|0,o[7]=o[7]+v|0}},n.hash.sha512=function(e){this._key[0]||this._precompute(),e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},n.hash.sha512.hash=function(e){return(new n.hash.sha512).update(e).finalize()},n.hash.sha512.prototype={blockSize:1024,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){typeof e=="string"&&(e=n.codec.utf8String.toBits(e));var t,r=this._buffer=n.bitArray.concat(this._buffer,e),i=this._length,s=this._length=i+n.bitArray.bitLength(e);for(t=1024+i&-1024;t<=s;t+=1024)this._block(r.splice(0,32));return this},finalize:function(){var e,t=this._buffer,r=this._h;t=n.bitArray.concat(t,[n.bitArray.partial(1,1)]);for(e=t.length+4;e&31;e++)t.push(0);t.push(0),t.push(0),t.push(Math.floor(this._length/4294967296)),t.push(this._length|0);while(t.length)this._block(t.splice(0,32));return this.reset(),r},_init:[],_initr:[12372232,13281083,9762859,1914609,15106769,4090911,4308331,8266105],_key:[],_keyr:[2666018,15689165,5061423,9034684,4764984,380953,1658779,7176472,197186,7368638,14987916,16757986,8096111,1480369,13046325,6891156,15813330,5187043,9229749,11312229,2818677,10937475,4324308,1135541,6741931,11809296,16458047,15666916,11046850,698149,229999,945776,13774844,2541862,12856045,9810911,11494366,7844520,15576806,8533307,15795044,4337665,16291729,5553712,15684120,6662416,7413802,12308920,13816008,4303699,9366425,10176680,13195875,4295371,6546291,11712675,15708924,1519456,15772530,6568428,6495784,8568297,13007125,7492395,2515356,12632583,14740254,7262584,1535930,13146278,16321966,1853211,294276,13051027,13221564,1051980,4080310,6651434,14088940,4675607],_precompute:function(){function r(e){return(e-Math.floor(e))*4294967296|0}function i(e){return(e-Math.floor(e))*1099511627776&255}var e=0,t=2,n;e:for(;e<80;t++){for(n=2;n*n<=t;n++)if(t%n===0)continue e;e<8&&(this._init[e*2]=r(Math.pow(t,.5)),this._init[e*2+1]=i(Math.pow(t,.5))<<24|this._initr[e]),this._key[e*2]=r(Math.pow(t,1/3)),this._key[e*2+1]=i(Math.pow(t,1/3))<<24|this._keyr[e],e++}},_block:function(e){var t,n,r,i=e.slice(0),s=this._h,o=this._key,u=s[0],a=s[1],f=s[2],l=s[3],c=s[4],h=s[5],p=s[6],d=s[7],v=s[8],m=s[9],g=s[10],y=s[11],b=s[12],w=s[13],E=s[14],S=s[15],x=u,T=a,N=f,C=l,k=c,L=h,A=p,O=d,M=v,_=m,D=g,P=y,H=b,B=w,j=E,F=S;for(t=0;t<80;t++){if(t<16)n=i[t*2],r=i[t*2+1];else{var I=i[(t-15)*2],q=i[(t-15)*2+1],R=(q<<31|I>>>1)^(q<<24|I>>>8)^I>>>7,U=(I<<31|q>>>1)^(I<<24|q>>>8)^(I<<25|q>>>7),z=i[(t-2)*2],W=i[(t-2)*2+1],X=(W<<13|z>>>19)^(z<<3|W>>>29)^z>>>6,V=(z<<13|W>>>19)^(W<<3|z>>>29)^(z<<26|W>>>6),$=i[(t-7)*2],J=i[(t-7)*2+1],K=i[(t-16)*2],Q=i[(t-16)*2+1];r=U+J,n=R+$+(r>>>0<U>>>0?1:0),r+=V,n+=X+(r>>>0<V>>>0?1:0),r+=Q,n+=K+(r>>>0<Q>>>0?1:0)}i[t*2]=n|=0,i[t*2+1]=r|=0;var G=M&D^~M&H,Y=_&P^~_&B,Z=x&N^x&k^N&k,et=T&C^T&L^C&L,tt=(T<<4|x>>>28)^(x<<30|T>>>2)^(x<<25|T>>>7),nt=(x<<4|T>>>28)^(T<<30|x>>>2)^(T<<25|x>>>7),rt=(_<<18|M>>>14)^(_<<14|M>>>18)^(M<<23|_>>>9),it=(M<<18|_>>>14)^(M<<14|_>>>18)^(_<<23|M>>>9),st=o[t*2],ot=o[t*2+1],ut=F+it,at=j+rt+(ut>>>0<F>>>0?1:0);ut+=Y,at+=G+(ut>>>0<Y>>>0?1:0),ut+=ot,at+=st+(ut>>>0<ot>>>0?1:0),ut=ut+r|0,at+=n+(ut>>>0<r>>>0?1:0);var ft=nt+et,lt=tt+Z+(ft>>>0<nt>>>0?1:0);j=H,F=B,H=D,B=P,D=M,P=_,_=O+ut|0,M=A+at+(_>>>0<O>>>0?1:0)|0,A=k,O=L,k=N,L=C,N=x,C=T,T=ut+ft|0,x=at+lt+(T>>>0<ut>>>0?1:0)|0}a=s[1]=a+T|0,s[0]=u+x+(a>>>0<T>>>0?1:0)|0,l=s[3]=l+C|0,s[2]=f+N+(l>>>0<C>>>0?1:0)|0,h=s[5]=h+L|0,s[4]=c+k+(h>>>0<L>>>0?1:0)|0,d=s[7]=d+O|0,s[6]=p+A+(d>>>0<O>>>0?1:0)|0,m=s[9]=m+_|0,s[8]=v+M+(m>>>0<_>>>0?1:0)|0,y=s[11]=y+P|0,s[10]=g+D+(y>>>0<P>>>0?1:0)|0,w=s[13]=w+B|0,s[12]=b+H+(w>>>0<B>>>0?1:0)|0,S=s[15]=S+F|0,s[14]=E+j+(S>>>0<F>>>0?1:0)|0}},n.hash.sha1=function(e){e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},n.hash.sha1.hash=function(e){return(new n.hash.sha1).update(e).finalize()},n.hash.sha1.prototype={blockSize:512,
reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){typeof e=="string"&&(e=n.codec.utf8String.toBits(e));var t,r=this._buffer=n.bitArray.concat(this._buffer,e),i=this._length,s=this._length=i+n.bitArray.bitLength(e);for(t=this.blockSize+i&-this.blockSize;t<=s;t+=this.blockSize)this._block(r.splice(0,16));return this},finalize:function(){var e,t=this._buffer,r=this._h;t=n.bitArray.concat(t,[n.bitArray.partial(1,1)]);for(e=t.length+2;e&15;e++)t.push(0);t.push(Math.floor(this._length/4294967296)),t.push(this._length|0);while(t.length)this._block(t.splice(0,16));return this.reset(),r},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(e,t,n,r){if(e<=19)return t&n|~t&r;if(e<=39)return t^n^r;if(e<=59)return t&n|t&r|n&r;if(e<=79)return t^n^r},_S:function(e,t){return t<<e|t>>>32-e},_block:function(e){var t,n,r,i,s,o,u,a=e.slice(0),f=this._h;r=f[0],i=f[1],s=f[2],o=f[3],u=f[4];for(t=0;t<=79;t++)t>=16&&(a[t]=this._S(1,a[t-3]^a[t-8]^a[t-14]^a[t-16])),n=this._S(5,r)+this._f(t,i,s,o)+u+a[t]+this._key[Math.floor(t/20)]|0,u=o,o=s,s=this._S(30,i),i=r,r=n;f[0]=f[0]+r|0,f[1]=f[1]+i|0,f[2]=f[2]+s|0,f[3]=f[3]+o|0,f[4]=f[4]+u|0}},n.mode.ccm={name:"ccm",encrypt:function(e,t,r,i,s){var o,u=t.slice(0),a,f=n.bitArray,l=f.bitLength(r)/8,c=f.bitLength(u)/8;s=s||64,i=i||[];if(l<7)throw new n.exception.invalid("ccm: iv must be at least 7 bytes");for(o=2;o<4&&c>>>8*o;o++);return o<15-l&&(o=15-l),r=f.clamp(r,8*(15-o)),a=n.mode.ccm._computeTag(e,t,r,i,s,o),u=n.mode.ccm._ctrMode(e,u,r,a,s,o),f.concat(u.data,u.tag)},decrypt:function(e,t,r,i,s){s=s||64,i=i||[];var o,u=n.bitArray,a=u.bitLength(r)/8,f=u.bitLength(t),l=u.clamp(t,f-s),c=u.bitSlice(t,f-s),h;f=(f-s)/8;if(a<7)throw new n.exception.invalid("ccm: iv must be at least 7 bytes");for(o=2;o<4&&f>>>8*o;o++);o<15-a&&(o=15-a),r=u.clamp(r,8*(15-o)),l=n.mode.ccm._ctrMode(e,l,r,c,s,o),h=n.mode.ccm._computeTag(e,l.data,r,i,s,o);if(!u.equal(l.tag,h))throw new n.exception.corrupt("ccm: tag doesn't match");return l.data},_computeTag:function(e,t,r,i,s,o){var u,a,f,l=[],c=n.bitArray,h=c._xor4;s/=8;if(s%2||s<4||s>16)throw new n.exception.invalid("ccm: invalid tag length");if(i.length>4294967295||t.length>4294967295)throw new n.exception.bug("ccm: can't deal with 4GiB or more data");u=[c.partial(8,(i.length?64:0)|s-2<<2|o-1)],u=c.concat(u,r),u[3]|=c.bitLength(t)/8,u=e.encrypt(u);if(i.length){a=c.bitLength(i)/8,a<=65279?l=[c.partial(16,a)]:a<=4294967295&&(l=c.concat([c.partial(16,65534)],[a])),l=c.concat(l,i);for(f=0;f<l.length;f+=4)u=e.encrypt(h(u,l.slice(f,f+4).concat([0,0,0])))}for(f=0;f<t.length;f+=4)u=e.encrypt(h(u,t.slice(f,f+4).concat([0,0,0])));return c.clamp(u,s*8)},_ctrMode:function(e,t,r,i,s,o){var u,a,f=n.bitArray,l=f._xor4,c,h=t.length,p=f.bitLength(t);c=f.concat([f.partial(8,o-1)],r).concat([0,0,0]).slice(0,4),i=f.bitSlice(l(i,e.encrypt(c)),0,s);if(!h)return{tag:i,data:[]};for(a=0;a<h;a+=4)c[3]++,u=e.encrypt(c),t[a]^=u[0],t[a+1]^=u[1],t[a+2]^=u[2],t[a+3]^=u[3];return{tag:i,data:f.clamp(t,p)}}},n.beware===undefined&&(n.beware={}),n.beware["CBC mode is dangerous because it doesn't protect message integrity."]=function(){n.mode.cbc={name:"cbc",encrypt:function(e,t,r,i){if(i&&i.length)throw new n.exception.invalid("cbc can't authenticate data");if(n.bitArray.bitLength(r)!==128)throw new n.exception.invalid("cbc iv must be 128 bits");var s,o=n.bitArray,u=o._xor4,a=o.bitLength(t),f=0,l=[];if(a&7)throw new n.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(s=0;f+128<=a;s+=4,f+=128)r=e.encrypt(u(r,t.slice(s,s+4))),l.splice(s,0,r[0],r[1],r[2],r[3]);return a=(16-(a>>3&15))*16843009,r=e.encrypt(u(r,o.concat(t,[a,a,a,a]).slice(s,s+4))),l.splice(s,0,r[0],r[1],r[2],r[3]),l},decrypt:function(e,t,r,i){if(i&&i.length)throw new n.exception.invalid("cbc can't authenticate data");if(n.bitArray.bitLength(r)!==128)throw new n.exception.invalid("cbc iv must be 128 bits");if(n.bitArray.bitLength(t)&127||!t.length)throw new n.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var s,o=n.bitArray,u=o._xor4,a,f,l=[];i=i||[];for(s=0;s<t.length;s+=4)a=t.slice(s,s+4),f=u(r,e.decrypt(a)),l.splice(s,0,f[0],f[1],f[2],f[3]),r=a;a=l[s-1]&255;if(a===0||a>16)throw new n.exception.corrupt("pkcs#5 padding corrupt");f=a*16843009;if(!o.equal(o.bitSlice([f,f,f,f],0,a*8),o.bitSlice(l,l.length*32-a*8,l.length*32)))throw new n.exception.corrupt("pkcs#5 padding corrupt");return o.bitSlice(l,0,l.length*32-a*8)}}},n.mode.gcm={name:"gcm",encrypt:function(e,t,r,i,s){var o,u=t.slice(0),a=n.bitArray;return s=s||128,i=i||[],o=n.mode.gcm._ctrMode(!0,e,u,i,r,s),a.concat(o.data,o.tag)},decrypt:function(e,t,r,i,s){var o,u=t.slice(0),a,f=n.bitArray,l=f.bitLength(u);s=s||128,i=i||[],s<=l?(a=f.bitSlice(u,l-s),u=f.bitSlice(u,0,l-s)):(a=u,u=[]),o=n.mode.gcm._ctrMode(!1,e,u,i,r,s);if(!f.equal(o.tag,a))throw new n.exception.corrupt("gcm: tag doesn't match");return o.data},_galoisMultiply:function(e,t){var r,i,s,o,u,a,f=n.bitArray,l=f._xor4;o=[0,0,0,0],u=t.slice(0);for(r=0;r<128;r++){s=(e[Math.floor(r/32)]&1<<31-r%32)!==0,s&&(o=l(o,u)),a=(u[3]&1)!==0;for(i=3;i>0;i--)u[i]=u[i]>>>1|(u[i-1]&1)<<31;u[0]=u[0]>>>1,a&&(u[0]=u[0]^225<<24)}return o},_ghash:function(e,t,r){var i,s,o=r.length;i=t.slice(0);for(s=0;s<o;s+=4)i[0]^=4294967295&r[s],i[1]^=4294967295&r[s+1],i[2]^=4294967295&r[s+2],i[3]^=4294967295&r[s+3],i=n.mode.gcm._galoisMultiply(i,e);return i},_ctrMode:function(e,t,r,i,s,o){var u,a,f,l,c,h,p,d,v,m,g,y,b=n.bitArray;v=r.length,m=b.bitLength(r),g=b.bitLength(i),y=b.bitLength(s),u=t.encrypt([0,0,0,0]),y===96?(a=s.slice(0),a=b.concat(a,[1])):(a=n.mode.gcm._ghash(u,[0,0,0,0],s),a=n.mode.gcm._ghash(u,a,[0,0,Math.floor(y/4294967296),y&4294967295])),f=n.mode.gcm._ghash(u,[0,0,0,0],i),h=a.slice(0),p=f.slice(0),e||(p=n.mode.gcm._ghash(u,f,r));for(c=0;c<v;c+=4)h[3]++,l=t.encrypt(h),r[c]^=l[0],r[c+1]^=l[1],r[c+2]^=l[2],r[c+3]^=l[3];return r=b.clamp(r,m),e&&(p=n.
mode.gcm._ghash(u,f,r)),d=[Math.floor(g/4294967296),g&4294967295,Math.floor(m/4294967296),m&4294967295],p=n.mode.gcm._ghash(u,p,d),l=t.encrypt(a),p[0]^=l[0],p[1]^=l[1],p[2]^=l[2],p[3]^=l[3],{tag:b.bitSlice(p,0,o),data:r}}},n.misc.hmac=function(e,t){this._hash=t=t||n.hash.sha256;var r=[[],[]],i,s=t.prototype.blockSize/32;this._baseHash=[new t,new t],e.length>s&&(e=t.hash(e));for(i=0;i<s;i++)r[0][i]=e[i]^909522486,r[1][i]=e[i]^1549556828;this._baseHash[0].update(r[0]),this._baseHash[1].update(r[1]),this._resultHash=new t(this._baseHash[0])},n.misc.hmac.prototype.encrypt=n.misc.hmac.prototype.mac=function(e){if(!this._updated)return this.update(e),this.digest(e);throw new n.exception.invalid("encrypt on already updated hmac called!")},n.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]),this._updated=!1},n.misc.hmac.prototype.update=function(e){this._updated=!0,this._resultHash.update(e)},n.misc.hmac.prototype.digest=function(){var e=this._resultHash.finalize(),t=(new this._hash(this._baseHash[1])).update(e).finalize();return this.reset(),t},n.misc.pbkdf2=function(e,t,r,i,s){r=r||1e3;if(i<0||r<0)throw n.exception.invalid("invalid params to pbkdf2");typeof e=="string"&&(e=n.codec.utf8String.toBits(e)),typeof t=="string"&&(t=n.codec.utf8String.toBits(t)),s=s||n.misc.hmac;var o=new s(e),u,a,f,l,c,h=[],p=n.bitArray;for(c=1;32*h.length<(i||1);c++){u=a=o.encrypt(p.concat(t,[c]));for(f=1;f<r;f++){a=o.encrypt(a);for(l=0;l<a.length;l++)u[l]^=a[l]}h=h.concat(u)}return i&&(h=p.clamp(h,i)),h},n.prng=function(e){this._pools=[new n.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=undefined,this._defaultParanoia=e,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},n.prng.prototype={randomWords:function(e,t){var r=[],i,s=this.isReady(t),o;if(s===this._NOT_READY)throw new n.exception.notReady("generator isn't seeded");s&this._REQUIRES_RESEED&&this._reseedFromPools(!(s&this._READY));for(i=0;i<e;i+=4)(i+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),o=this._gen4words(),r.push(o[0],o[1],o[2],o[3]);return this._gate(),r.slice(0,e)},setDefaultParanoia:function(e,t){if(e===0&&t!=="Setting paranoia=0 will ruin your security; use it only for testing")throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=e},addEntropy:function(e,t,r){r=r||"user";var i,s,o,u=(new Date).valueOf(),a=this._robins[r],f=this.isReady(),l=0,c;i=this._collectorIds[r],i===undefined&&(i=this._collectorIds[r]=this._collectorIdNext++),a===undefined&&(a=this._robins[r]=0),this._robins[r]=(this._robins[r]+1)%this._pools.length;switch(typeof e){case"number":t===undefined&&(t=1),this._pools[a].update([i,this._eventId++,1,t,u,1,e|0]);break;case"object":c=Object.prototype.toString.call(e);if(c==="[object Uint32Array]"){o=[];for(s=0;s<e.length;s++)o.push(e[s]);e=o}else{c!=="[object Array]"&&(l=1);for(s=0;s<e.length&&!l;s++)typeof e[s]!="number"&&(l=1)}if(!l){if(t===undefined){t=0;for(s=0;s<e.length;s++){o=e[s];while(o>0)t++,o>>>=1}}this._pools[a].update([i,this._eventId++,2,t,u,e.length].concat(e))}break;case"string":t===undefined&&(t=e.length),this._pools[a].update([i,this._eventId++,3,t,u,e.length]),this._pools[a].update(e);break;default:l=1}if(l)throw new n.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[a]+=t,this._poolStrength+=t,f===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(e){var t=this._PARANOIA_LEVELS[e!==undefined?e:this._defaultParanoia];return this._strength&&this._strength>=t?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=t?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(e){var t=this._PARANOIA_LEVELS[e?e:this._defaultParanoia];return this._strength>=t?1:this._poolStrength>t?1:this._poolStrength/t},startCollectors:function(){if(this._collectorsStarted)return;this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector),touchCollector:this._bind(this._touchCollector)};if(window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.addEventListener("touchmove",this._eventListener.touchCollector,!1);else{if(!document.attachEvent)throw new n.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0},stopCollectors:function(){if(!this._collectorsStarted)return;window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1),window.removeEventListener("touchmove"
,this._eventListener.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1},addEventListener:function(e,t){this._callbacks[e][this._callbackI++]=t},removeEventListener:function(e,t){var n,r,i=this._callbacks[e],s=[];for(r in i)i.hasOwnProperty(r)&&i[r]===t&&s.push(r);for(n=0;n<s.length;n++)r=s[n],delete i[r]},_bind:function(e){var t=this;return function(){e.apply(t,arguments)}},_gen4words:function(){for(var e=0;e<4;e++){this._counter[e]=this._counter[e]+1|0;if(this._counter[e])break}return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new n.cipher.aes(this._key)},_reseed:function(e){this._key=n.hash.sha256.hash(this._key.concat(e)),this._cipher=new n.cipher.aes(this._key);for(var t=0;t<4;t++){this._counter[t]=this._counter[t]+1|0;if(this._counter[t])break}},_reseedFromPools:function(e){var t=[],r=0,i;this._nextReseed=t[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED;for(i=0;i<16;i++)t.push(Math.random()*4294967296|0);for(i=0;i<this._pools.length;i++){t=t.concat(this._pools[i].finalize()),r+=this._poolEntropy[i],this._poolEntropy[i]=0;if(!e&&this._reseedCount&1<<i)break}this._reseedCount>=1<<this._pools.length&&(this._pools.push(new n.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=r,r>this._strength&&(this._strength=r),this._reseedCount++,this._reseed(t)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(e){var t,r;try{t=e.x||e.clientX||e.offsetX||0,r=e.y||e.clientY||e.offsetY||0}catch(i){t=0,r=0}t!=0&&r!=0&&n.random.addEntropy([t,r],2,"mouse"),this._addCurrentTimeToEntropy(0)},_touchCollector:function(e){var t=e.touches[0]||e.changedTouches[0],r=t.pageX||t.clientX,i=t.pageY||t.clientY;n.random.addEntropy([r,i],1,"touch"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(e){typeof window!="undefined"&&window.performance&&typeof window.performance.now=="function"?n.random.addEntropy(window.performance.now(),e,"loadtime"):n.random.addEntropy((new Date).valueOf(),e,"loadtime")},_accelerometerCollector:function(e){var t=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z;if(window.orientation){var r=window.orientation;typeof r=="number"&&n.random.addEntropy(r,1,"accelerometer")}t&&n.random.addEntropy(t,2,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(e,t){var r,i=n.random._callbacks[e],s=[];for(r in i)i.hasOwnProperty(r)&&s.push(i[r]);for(r=0;r<s.length;r++)s[r](t)}},n.random=new n.prng(6),function(){function e(){try{return require("crypto")}catch(e){return null}}try{var t,r,i;if(typeof module!="undefined"&&module.exports&&(r=e())&&r.randomBytes)t=r.randomBytes(128),t=new Uint32Array((new Uint8Array(t)).buffer),n.random.addEntropy(t,1024,"crypto.randomBytes");else if(typeof window!="undefined"&&typeof Uint32Array!="undefined"){i=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(i);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)return;window.msCrypto.getRandomValues(i)}n.random.addEntropy(i,1024,"crypto.getRandomValues")}}catch(s){typeof window!="undefined"&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(s))}}(),n.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},_encrypt:function(e,t,r,i){r=r||{},i=i||{};var s=n.json,o=s._add({iv:n.random.randomWords(4,0)},s.defaults),u,a,f;s._add(o,r),f=o.adata,typeof o.salt=="string"&&(o.salt=n.codec.base64.toBits(o.salt)),typeof o.iv=="string"&&(o.iv=n.codec.base64.toBits(o.iv));if(!n.mode[o.mode]||!n.cipher[o.cipher]||typeof e=="string"&&o.iter<=100||o.ts!==64&&o.ts!==96&&o.ts!==128||o.ks!==128&&o.ks!==192&&o.ks!==256||o.iv.length<2||o.iv.length>4)throw new n.exception.invalid("json encrypt: invalid parameters");return typeof e=="string"?(u=n.misc.cachedPbkdf2(e,o),e=u.key.slice(0,o.ks/32),o.salt=u.salt):n.ecc&&e instanceof n.ecc.elGamal.publicKey&&(u=e.kem(),o.kemtag=u.tag,e=u.key.slice(0,o.ks/32)),typeof t=="string"&&(t=n.codec.utf8String.toBits(t)),typeof f=="string"&&(f=n.codec.utf8String.toBits(f)),a=new n.cipher[o.cipher](e),s._add(i,o),i.key=e,o.ct=n.mode[o.mode].encrypt(a,t,o.iv,f,o.ts),o},encrypt:function(e,t,r,i){var s=n.json,o=s._encrypt.apply(s,arguments);return s.encode(o)},_decrypt:function(e,t,r,i){r=r||{},i=i||{};var s=n.json,o=s._add(s._add(s._add({},s.defaults),t),r,!0),u,a,f,l=o.adata;typeof o.salt=="string"&&(o.salt=n.codec.base64.toBits(o.salt)),typeof o.iv=="string"&&(o.iv=n.codec.base64.toBits(o.iv));if(!n.mode[o.mode]||!n.cipher[o.cipher]||typeof e=="string"&&o.iter<=100||o.ts!==64&&o.ts!==96&&o.ts!==128||o.ks!==128&&o.ks!==192&&o.ks!==256||!o.iv||o.iv.length<2||o.iv.length>4)throw new n.exception.invalid("json decrypt: invalid parameters");return typeof e=="string"?(a=n.misc.cachedPbkdf2(e,o),e=a.key.slice(0,o.ks/32),o.salt=a.salt):n.ecc&&e instanceof n.ecc.elGamal.secretKey&&(e=e.unkem(n.codec.base64.toBits(o.kemtag)).slice(0,o.ks/32)),typeof l=="string"&&(l=n.codec.utf8String.toBits(l)),f=new n.cipher[o.cipher](e),u=n.mode[o.mode].decrypt(f,o.ct,o.iv,l,o.ts),s._add(i,o),i.key=e,r.raw===1?u:n.codec.utf8String.fromBits(u)},decrypt:function(e,t,r,i){var s=n.json;return s._decrypt(e,s.decode(t),r,i)},encode:function(e){var t,r="{",i="";for(t in e)if(e.hasOwnProperty(t)){if(!t.match(/^[a-z0-9]+$/i))throw new n.exception.invalid("json encode: invalid property name");r+=i+'"'+t+'":',i=",";switch(typeof e[t]){case"number":case"boolean":r+=e[t];break;case"string":r+='"'+escape(e[t])+'"';break;case"object":r+='"'+n.codec.base64.fromBits(e[t],0)+'"';break;default:throw new n.exception.bug("json encode: unsupported type"
)}}return r+"}"},decode:function(e){e=e.replace(/\s/g,"");if(!e.match(/^\{.*\}$/))throw new n.exception.invalid("json decode: this isn't json!");var t=e.replace(/^\{|\}$/g,"").split(/,/),r={},i,s;for(i=0;i<t.length;i++){if(!(s=t[i].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new n.exception.invalid("json decode: this isn't json!");s[3]?r[s[2]]=parseInt(s[3],10):s[4]?r[s[2]]=s[2].match(/^(ct|salt|iv)$/)?n.codec.base64.toBits(s[4]):unescape(s[4]):s[5]&&(r[s[2]]=s[5]==="true")}return r},_add:function(e,t,r){e===undefined&&(e={});if(t===undefined)return e;var i;for(i in t)if(t.hasOwnProperty(i)){if(r&&e[i]!==undefined&&e[i]!==t[i])throw new n.exception.invalid("required parameter overridden");e[i]=t[i]}return e},_subtract:function(e,t){var n={},r;for(r in e)e.hasOwnProperty(r)&&e[r]!==t[r]&&(n[r]=e[r]);return n},_filter:function(e,t){var n={},r;for(r=0;r<t.length;r++)e[t[r]]!==undefined&&(n[t[r]]=e[t[r]]);return n}},n.encrypt=n.json.encrypt,n.decrypt=n.json.decrypt,n.misc._pbkdf2Cache={},n.misc.cachedPbkdf2=function(e,t){var r=n.misc._pbkdf2Cache,i,s,o,u,a;return t=t||{},a=t.iter||1e3,s=r[e]=r[e]||{},i=s[a]=s[a]||{firstSalt:t.salt&&t.salt.length?t.salt.slice(0):n.random.randomWords(2,0)},u=t.salt===undefined?i.firstSalt:t.salt,i[u]=i[u]||n.misc.pbkdf2(e,u,t.iter),{key:i[u].slice(0),salt:u.slice(0)}},n.bn=function(e){this.initWith(e)},n.bn.prototype={radix:24,maxMul:8,_class:n.bn,copy:function(){return new this._class(this)},initWith:function(e){var t=0,n;switch(typeof e){case"object":this.limbs=e.limbs.slice(0);break;case"number":this.limbs=[e],this.normalize();break;case"string":e=e.replace(/^0x/,""),this.limbs=[],n=this.radix/4;for(t=0;t<e.length;t+=n)this.limbs.push(parseInt(e.substring(Math.max(e.length-t-n,0),e.length-t),16));break;default:this.limbs=[0]}return this},equals:function(e){typeof e=="number"&&(e=new this._class(e));var t=0,n;this.fullReduce(),e.fullReduce();for(n=0;n<this.limbs.length||n<e.limbs.length;n++)t|=this.getLimb(n)^e.getLimb(n);return t===0},getLimb:function(e){return e>=this.limbs.length?0:this.limbs[e]},greaterEquals:function(e){typeof e=="number"&&(e=new this._class(e));var t=0,n=0,r,i,s;r=Math.max(this.limbs.length,e.limbs.length)-1;for(;r>=0;r--)i=this.getLimb(r),s=e.getLimb(r),n|=s-i&~t,t|=i-s&~n;return(n|~t)>>>31},toString:function(){this.fullReduce();var e="",t,n,r=this.limbs;for(t=0;t<this.limbs.length;t++){n=r[t].toString(16);while(t<this.limbs.length-1&&n.length<6)n="0"+n;e=n+e}return"0x"+e},addM:function(e){typeof e!="object"&&(e=new this._class(e));var t,n=this.limbs,r=e.limbs;for(t=n.length;t<r.length;t++)n[t]=0;for(t=0;t<r.length;t++)n[t]+=r[t];return this},doubleM:function(){var e,t=0,n,r=this.radix,i=this.radixMask,s=this.limbs;for(e=0;e<s.length;e++)n=s[e],n=n+n+t,s[e]=n&i,t=n>>r;return t&&s.push(t),this},halveM:function(){var e,t=0,n,r=this.radix,i=this.limbs;for(e=i.length-1;e>=0;e--)n=i[e],i[e]=n+t>>1,t=(n&1)<<r;return i[i.length-1]||i.pop(),this},subM:function(e){typeof e!="object"&&(e=new this._class(e));var t,n=this.limbs,r=e.limbs;for(t=n.length;t<r.length;t++)n[t]=0;for(t=0;t<r.length;t++)n[t]-=r[t];return this},mod:function(e){var t=!this.greaterEquals(new n.bn(0));e=(new n.bn(e)).normalize();var r=(new n.bn(this)).normalize(),i=0;t&&(r=(new n.bn(0)).subM(r).normalize());for(;r.greaterEquals(e);i++)e.doubleM();t&&(r=e.sub(r).normalize());for(;i>0;i--)e.halveM(),r.greaterEquals(e)&&r.subM(e).normalize();return r.trim()},inverseMod:function(e){var t=new n.bn(1),r=new n.bn(0),i=new n.bn(this),s=new n.bn(e),o,u,a=1;if(!(e.limbs[0]&1))throw new n.exception.invalid("inverseMod: p must be odd");do{i.limbs[0]&1&&(i.greaterEquals(s)||(o=i,i=s,s=o,o=t,t=r,r=o),i.subM(s),i.normalize(),t.greaterEquals(r)||t.addM(e),t.subM(r)),i.halveM(),t.limbs[0]&1&&t.addM(e),t.normalize(),t.halveM();for(u=a=0;u<i.limbs.length;u++)a|=i.limbs[u]}while(a);if(!s.equals(1))throw new n.exception.invalid("inverseMod: p and x must be relatively prime");return r},add:function(e){return this.copy().addM(e)},sub:function(e){return this.copy().subM(e)},mul:function(e){typeof e=="number"&&(e=new this._class(e));var t,n,r=this.limbs,i=e.limbs,s=r.length,o=i.length,u=new this._class,a=u.limbs,f,l=this.maxMul;for(t=0;t<this.limbs.length+e.limbs.length+1;t++)a[t]=0;for(t=0;t<s;t++){f=r[t];for(n=0;n<o;n++)a[t+n]+=f*i[n];--l||(l=this.maxMul,u.cnormalize())}return u.cnormalize().reduce()},square:function(){return this.mul(this)},power:function(e){typeof e=="number"?e=[e]:e.limbs!==undefined&&(e=e.normalize().limbs);var t,n,r=new this._class(1),i=this;for(t=0;t<e.length;t++)for(n=0;n<this.radix;n++)e[t]&1<<n&&(r=r.mul(i)),i=i.square();return r},mulmod:function(e,t){return this.mod(t).mul(e.mod(t)).mod(t)},powermod:function(e,t){var r=new n.bn(1),i=new n.bn(this),s=new n.bn(e);for(;;){s.limbs[0]&1&&(r=r.mulmod(i,t)),s.halveM();if(s.equals(0))break;i=i.mulmod(i,t)}return r.normalize().reduce()},trim:function(){var e=this.limbs,t;do t=e.pop();while(e.length&&t===0);return e.push(t),this},reduce:function(){return this},fullReduce:function(){return this.normalize()},normalize:function(){var e=0,t,n=this.placeVal,r=this.ipv,i,s,o=this.limbs,u=o.length,a=this.radixMask;for(t=0;t<u||e!==0&&e!==-1;t++)i=(o[t]||0)+e,s=o[t]=i&a,e=(i-s)*r;return e===-1&&(o[t-1]-=n),this},cnormalize:function(){var e=0,t,n=this.ipv,r,i,s=this.limbs,o=s.length,u=this.radixMask;for(t=0;t<o-1;t++)r=s[t]+e,i=s[t]=r&u,e=(r-i)*n;return s[t]+=e,this},toBits:function(e){this.fullReduce(),e=e||this.exponent||this.bitLength();var t=Math.floor((e-1)/24),r=n.bitArray,i=(e+7&-8)%this.radix||this.radix,s=[r.partial(i,this.getLimb(t))];for(t--;t>=0;t--)s=r.concat(s,[r.partial(Math.min(this.radix,e),this.getLimb(t))]),e-=this.radix;return s},bitLength:function(){this.fullReduce();var e=this.radix*(this.limbs.length-1),t=this.limbs[this.limbs.length-1];for(;t;t>>>=1)e++;return e+7&-8}},n.bn.fromBits=function(e){var t=this,r=new t,i=[],s=n.bitArray,o=this.prototype,u=Math
.min(this.bitLength||4294967296,s.bitLength(e)),a=u%o.radix||o.radix;i[0]=s.extract(e,0,a);for(;a<u;a+=o.radix)i.unshift(s.extract(e,a,o.radix));return r.limbs=i,r},n.bn.prototype.ipv=1/(n.bn.prototype.placeVal=Math.pow(2,n.bn.prototype.radix)),n.bn.prototype.radixMask=(1<<n.bn.prototype.radix)-1,n.bn.pseudoMersennePrime=function(e,t){function r(e){this.initWith(e)}var i=r.prototype=new n.bn,s,o,u;u=i.modOffset=Math.ceil(o=e/i.radix),i.exponent=e,i.offset=[],i.factor=[],i.minOffset=u,i.fullMask=0,i.fullOffset=[],i.fullFactor=[],i.modulus=r.modulus=new n.bn(Math.pow(2,e)),i.fullMask=0|-Math.pow(2,e%i.radix);for(s=0;s<t.length;s++)i.offset[s]=Math.floor(t[s][0]/i.radix-o),i.fullOffset[s]=Math.ceil(t[s][0]/i.radix-o),i.factor[s]=t[s][1]*Math.pow(.5,e-t[s][0]+i.offset[s]*i.radix),i.fullFactor[s]=t[s][1]*Math.pow(.5,e-t[s][0]+i.fullOffset[s]*i.radix),i.modulus.addM(new n.bn(Math.pow(2,t[s][0])*t[s][1])),i.minOffset=Math.min(i.minOffset,-i.offset[s]);return i._class=r,i.modulus.cnormalize(),i.reduce=function(){var e,t,n,r=this.modOffset,i=this.limbs,s=this.offset,o=this.offset.length,u=this.factor,a;e=this.minOffset;while(i.length>r){n=i.pop(),a=i.length;for(t=0;t<o;t++)i[a+s[t]]-=u[t]*n;e--,e||(i.push(0),this.cnormalize(),e=this.minOffset)}return this.cnormalize(),this},i._strongReduce=i.fullMask===-1?i.reduce:function(){var e=this.limbs,t=e.length-1,n,r;this.reduce();if(t===this.modOffset-1){r=e[t]&this.fullMask,e[t]-=r;for(n=0;n<this.fullOffset.length;n++)e[t+this.fullOffset[n]]-=this.fullFactor[n]*r;this.normalize()}},i.fullReduce=function(){var e,t;this._strongReduce(),this.addM(this.modulus),this.addM(this.modulus),this.normalize(),this._strongReduce();for(t=this.limbs.length;t<this.modOffset;t++)this.limbs[t]=0;e=this.greaterEquals(this.modulus);for(t=0;t<this.limbs.length;t++)this.limbs[t]-=this.modulus.limbs[t]*e;return this.cnormalize(),this},i.inverse=function(){return this.power(this.modulus.sub(2))},r.fromBits=n.bn.fromBits,r};var r=n.bn.pseudoMersennePrime;n.bn.prime={p127:r(127,[[0,-1]]),p25519:r(255,[[0,-19]]),p192k:r(192,[[32,-1],[12,-1],[8,-1],[7,-1],[6,-1],[3,-1],[0,-1]]),p224k:r(224,[[32,-1],[12,-1],[11,-1],[9,-1],[7,-1],[4,-1],[1,-1],[0,-1]]),p256k:r(256,[[32,-1],[9,-1],[8,-1],[7,-1],[6,-1],[4,-1],[0,-1]]),p192:r(192,[[0,-1],[64,-1]]),p224:r(224,[[0,1],[96,-1]]),p256:r(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:r(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:r(521,[[0,-1]])},n.bn.random=function(e,t){typeof e!="object"&&(e=new n.bn(e));var r,i,s=e.limbs.length,o=e.limbs[s-1]+1,u=new n.bn;for(;;){do r=n.random.randomWords(s,t),r[s-1]<0&&(r[s-1]+=4294967296);while(Math.floor(r[s-1]/o)===Math.floor(4294967296/o));r[s-1]%=o;for(i=0;i<s-1;i++)r[i]&=e.radixMask;u.limbs=r;if(!u.greaterEquals(e))return u}},n.ecc={},n.ecc.point=function(e,t,r){t===undefined?this.isIdentity=!0:(t instanceof n.bn&&(t=new e.field(t)),r instanceof n.bn&&(r=new e.field(r)),this.x=t,this.y=r,this.isIdentity=!1),this.curve=e},n.ecc.point.prototype={toJac:function(){return new n.ecc.pointJac(this.curve,this.x,this.y,new this.curve.field(1))},mult:function(e){return this.toJac().mult(e,this).toAffine()},mult2:function(e,t,n){return this.toJac().mult2(e,this,t,n).toAffine()},multiples:function(){var e,t,r;if(this._multiples===undefined){r=this.toJac().doubl(),e=this._multiples=[new n.ecc.point(this.curve),this,r.toAffine()];for(t=3;t<16;t++)r=r.add(this),e.push(r.toAffine())}return this._multiples},isValid:function(){return this.y.square().equals(this.curve.b.add(this.x.mul(this.curve.a.add(this.x.square()))))},toBits:function(){return n.bitArray.concat(this.x.toBits(),this.y.toBits())}},n.ecc.pointJac=function(e,t,n,r){t===undefined?this.isIdentity=!0:(this.x=t,this.y=n,this.z=r,this.isIdentity=!1),this.curve=e},n.ecc.pointJac.prototype={add:function(e){var t=this,r,i,s,o,u,a,f,l,c,h,p;if(t.curve!==e.curve)throw"sjcl.ecc.add(): Points must be on the same curve to add them!";return t.isIdentity?e.toJac():e.isIdentity?t:(r=t.z.square(),i=e.x.mul(r).subM(t.x),i.equals(0)?t.y.equals(e.y.mul(r.mul(t.z)))?t.doubl():new n.ecc.pointJac(t.curve):(s=e.y.mul(r.mul(t.z)).subM(t.y),o=i.square(),u=s.square(),a=i.square().mul(i).addM(t.x.add(t.x).mul(o)),f=u.subM(a),l=t.x.mul(o).subM(f).mul(s),c=t.y.mul(i.square().mul(i)),h=l.subM(c),p=t.z.mul(i),new n.ecc.pointJac(this.curve,f,h,p)))},doubl:function(){if(this.isIdentity)return this;var e=this.y.square(),t=e.mul(this.x.mul(4)),r=e.square().mul(8),i=this.z.square(),s=this.curve.a.toString()==(new n.bn(-3)).toString()?this.x.sub(i).mul(3).mul(this.x.add(i)):this.x.square().mul(3).add(i.square().mul(this.curve.a)),o=s.square().subM(t).subM(t),u=t.sub(o).mul(s).subM(r),a=this.y.add(this.y).mul(this.z);return new n.ecc.pointJac(this.curve,o,u,a)},toAffine:function(){if(this.isIdentity||this.z.equals(0))return new n.ecc.point(this.curve);var e=this.z.inverse(),t=e.square();return new n.ecc.point(this.curve,this.x.mul(t).fullReduce(),this.y.mul(t.mul(e)).fullReduce())},mult:function(e,t){typeof e=="number"?e=[e]:e.limbs!==undefined&&(e=e.normalize().limbs);var r,i,s=(new n.ecc.point(this.curve)).toJac(),o=t.multiples();for(r=e.length-1;r>=0;r--)for(i=n.bn.prototype.radix-4;i>=0;i-=4)s=s.doubl().doubl().doubl().doubl().add(o[e[r]>>i&15]);return s},mult2:function(e,t,r,i){typeof e=="number"?e=[e]:e.limbs!==undefined&&(e=e.normalize().limbs),typeof r=="number"?r=[r]:r.limbs!==undefined&&(r=r.normalize().limbs);var s,o,u=(new n.ecc.point(this.curve)).toJac(),a=t.multiples(),f=i.multiples(),l,c;for(s=Math.max(e.length,r.length)-1;s>=0;s--){l=e[s]|0,c=r[s]|0;for(o=n.bn.prototype.radix-4;o>=0;o-=4)u=u.doubl().doubl().doubl().doubl().add(a[l>>o&15]).add(f[c>>o&15])}return u},isValid:function(){var e=this.z.square(),t=e.square(),n=t.mul(e);return this.y.square().equals(this.curve.b.mul(n).add(this.x.mul(this.curve.a.mul(t).add(this.x.square()))))}},n.ecc.curve=function(e,t,r,i,s,o){this.field=e,this.r=new n.bn(t),this.a=new e(r),this.b=new e(i),this.G=new n.ecc.point(this,new e(s),new e(o))}
,n.ecc.curve.prototype.fromBits=function(e){var t=n.bitArray,r=this.field.prototype.exponent+7&-8,i=new n.ecc.point(this,this.field.fromBits(t.bitSlice(e,0,r)),this.field.fromBits(t.bitSlice(e,r,2*r)));if(!i.isValid())throw new n.exception.corrupt("not on the curve!");return i},n.ecc.curves={c192:new n.ecc.curve(n.bn.prime.p192,"0xffffffffffffffffffffffff99def836146bc9b1b4d22831",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new n.ecc.curve(n.bn.prime.p224,"0xffffffffffffffffffffffffffff16a2e0b8f03e13dd29455c5c2a3d",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),c256:new n.ecc.curve(n.bn.prime.p256,"0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new n.ecc.curve(n.bn.prime.p384,"0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),k192:new n.ecc.curve(n.bn.prime.p192k,"0xfffffffffffffffffffffffe26f2fc170f69466a74defd8d",0,3,"0xdb4ff10ec057e9ae26b07d0280b7f4341da5d1b1eae06c7d","0x9b2f2f6d9c5628a7844163d015be86344082aa88d95e2f9d"),k224:new n.ecc.curve(n.bn.prime.p224k,"0x010000000000000000000000000001dce8d2ec6184caf0a971769fb1f7",0,5,"0xa1455b334df099df30fc28a169a467e9e47075a90f7e650eb6b7a45c","0x7e089fed7fba344282cafbd6f7e319f7c0b0bd59e2ca4bdb556d61a5"),k256:new n.ecc.curve(n.bn.prime.p256k,"0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",0,7,"0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},n.ecc.basicKey={publicKey:function(e,t){this._curve=e,this._curveBitLength=e.r.bitLength(),t instanceof Array?this._point=e.fromBits(t):this._point=t,this.get=function(){var e=this._point.toBits(),t=n.bitArray.bitLength(e),r=n.bitArray.bitSlice(e,0,t/2),i=n.bitArray.bitSlice(e,t/2);return{x:r,y:i}}},secretKey:function(e,t){this._curve=e,this._curveBitLength=e.r.bitLength(),this._exponent=t,this.get=function(){return this._exponent.toBits()}}},n.ecc.basicKey.generateKeys=function(e){return function(r,i,s){r=r||256;if(typeof r=="number"){r=n.ecc.curves["c"+r];if(r===undefined)throw new n.exception.invalid("no such curve")}s=s||n.bn.random(r.r,i);var o=r.G.mult(s);return{pub:new n.ecc[e].publicKey(r,o),sec:new n.ecc[e].secretKey(r,s)}}},n.ecc.elGamal={generateKeys:n.ecc.basicKey.generateKeys("elGamal"),publicKey:function(e,t){n.ecc.basicKey.publicKey.apply(this,arguments)},secretKey:function(e,t){n.ecc.basicKey.secretKey.apply(this,arguments)}},n.ecc.elGamal.publicKey.prototype={kem:function(e){var t=n.bn.random(this._curve.r,e),r=this._curve.G.mult(t).toBits(),i=n.hash.sha256.hash(this._point.mult(t).toBits());return{key:i,tag:r}}},n.ecc.elGamal.secretKey.prototype={unkem:function(e){return n.hash.sha256.hash(this._curve.fromBits(e).mult(this._exponent).toBits())},dh:function(e){return n.hash.sha256.hash(e._point.mult(this._exponent).toBits())},dhJavaEc:function(e){return e._point.mult(this._exponent).x.toBits()}},n.ecc.ecdsa={generateKeys:n.ecc.basicKey.generateKeys("ecdsa")},n.ecc.ecdsa.publicKey=function(e,t){n.ecc.basicKey.publicKey.apply(this,arguments)},n.ecc.ecdsa.publicKey.prototype={verify:function(e,t,r){n.bitArray.bitLength(e)>this._curveBitLength&&(e=n.bitArray.clamp(e,this._curveBitLength));var i=n.bitArray,s=this._curve.r,o=this._curveBitLength,u=n.bn.fromBits(i.bitSlice(t,0,o)),a=n.bn.fromBits(i.bitSlice(t,o,2*o)),f=r?a:a.inverseMod(s),l=n.bn.fromBits(e).mul(f).mod(s),c=u.mul(f).mod(s),h=this._curve.G.mult2(l,c,this._point).x;if(u.equals(0)||a.equals(0)||u.greaterEquals(s)||a.greaterEquals(s)||!h.equals(u)){if(r===undefined)return this.verify(e,t,!0);throw new n.exception.corrupt("signature didn't check out")}return!0}},n.ecc.ecdsa.secretKey=function(e,t){n.ecc.basicKey.secretKey.apply(this,arguments)},n.ecc.ecdsa.secretKey.prototype={sign:function(e,t,r,i){n.bitArray.bitLength(e)>this._curveBitLength&&(e=n.bitArray.clamp(e,this._curveBitLength));var s=this._curve.r,o=s.bitLength(),u=i||n.bn.random(s.sub(1),t).add(1),a=this._curve.G.mult(u).x.mod(s),f=n.bn.fromBits(e).add(a.mul(this._exponent)),l=r?f.inverseMod(s).mul(u).mod(s):f.mul(u.inverseMod(s)).mod(s);return n.bitArray.concat(a.toBits(o),l.toBits(o))}},n.keyexchange.srp={makeVerifier:function(e,t,r,i){var s;return s=n.keyexchange.srp.makeX(e,t,r),s=n.bn.fromBits(s),i.g.powermod(s,i.N)},makeX:function(e,t,r){var i=n.hash.sha1.hash(e+":"+t);return n.hash.sha1.hash(n.bitArray.concat(r,i))},knownGroup:function(e){return typeof e!="string"&&(e=e.toString()),n.keyexchange.srp._didInitKnownGroups||n.keyexchange.srp._initKnownGroups(),n.keyexchange.srp._knownGroups[e]},_didInitKnownGroups:!1,_initKnownGroups:function(){var e,t,r;for(e=0;e<n.keyexchange.srp._knownGroupSizes.length;e++)t=n.keyexchange.srp._knownGroupSizes[e].toString(),r=n.keyexchange.srp._knownGroups[t],r.N=new n.bn(r.N),r.g=new n.bn(r.g);n.keyexchange.srp._didInitKnownGroups=!0},_knownGroupSizes:[1024,1536,2048],_knownGroups:{1024:{N:"EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE48E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B297BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9AFD5138FE8376435B9FC61D2FC0EB06E3",g:2},1536:{N:"9DEF3CAFB939277AB1F12A8617A47BBBDBA51DF499AC4C80BEEEA9614B19CC4D5F4F5F556E27CBDE51C6A94BE4607A291558903BA0D0F84380B655BB9A22E8DCDF028A7CEC67F0D08134B1C8B97989149B609E0BE3BAB63D47548381DBC5B1FC764E3F4B53DD9DA1158BFD3E2B9C8CF56EDF019539349627DB2FD53D24B7C48665772E437D6C7F8CE442734AF7CCB7AE837C264AE3A9BEB87F8A2FE9B8B5292E5A021FFF5E91479E8CE7A28C2442C6F315180F93499A234DCF76E3FED135F9BB"
,g:2},2048:{N:"AC6BDB41324A9A9BF166DE5E1389582FAF72B6651987EE07FC3192943DB56050A37329CBB4A099ED8193E0757767A13DD52312AB4B03310DCD7F48A9DA04FD50E8083969EDB767B0CF6095179A163AB3661A05FBD5FAAAE82918A9962F0B93B855F97993EC975EEAA80D740ADBF4FF747359D041D5C33EA71D281E446B14773BCA97B43A23FB801676BD207A436C6481F1D2B9078717461A5B9D32E688F87748544523B524B0D57D5EA77A2775D2ECFA032CFBDBF52FB3786160279004E57AE6AF874E7303CE53299CCC041C7BC308D82A5698F3A8D0C38271AE35F8E9DBFBB694B5C803D89F7AE435DE236D525F54759B65E372FCD68EF20FA7111F9E4AFF73",g:2}}},e.Crypto=e.Crypto||{},e.Crypto.sjcl=n},"@VERSION@",{requires:[]});
